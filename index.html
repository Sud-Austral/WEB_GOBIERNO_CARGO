<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Gestión Candidatos</title>
</head>

<body class="bg-white overflow-hidden">

    <div class="row g-0 vh-100">
        <!-- Left Side: Cover Image -->
        <div class="col-lg-7 d-none d-lg-block position-relative overflow-hidden">
            <div class="position-absolute w-100 h-100" style="
                background-image: url('https://images.unsplash.com/photo-1497366216548-37526070297c?q=80&w=2301&auto=format&fit=crop');
                background-size: cover;
                background-position: center;
                animation: zoomIn 20s infinite alternate;">
            </div>
            <div class="position-absolute top-0 start-0 w-100 h-100"
                style="background: linear-gradient(135deg, rgba(30, 58, 138, 0.9), rgba(15, 23, 42, 0.6));"></div>

            <div class="position-absolute bottom-0 start-0 p-5 text-white" style="z-index: 2;">
                <div class="mb-4">
                    <span
                        class="badge bg-white bg-opacity-25 border border-white border-opacity-25 text-white mb-3 px-3 py-2 rounded-pill">Sistema
                        de Gestión v2.0</span>
                    <h1 class="fw-bold display-4 mb-2">Gestión de Talento</h1>
                    <p class="lead opacity-90" style="max-width: 600px;">Optimice sus procesos de selección, evalúe
                        candidatos y tome decisiones basadas en datos.</p>
                </div>
                <div class="d-flex gap-4 opacity-75 small">
                    <div class="d-flex align-items-center"><i class="fas fa-shield-alt me-2"></i> Seguro</div>
                    <div class="d-flex align-items-center"><i class="fas fa-bolt me-2"></i> Rápido</div>
                    <div class="d-flex align-items-center"><i class="fas fa-sync me-2"></i> Tiempo Real</div>
                </div>
            </div>
        </div>

        <!-- Right Side: Login Form -->
        <div class="col-lg-5 col-md-12 d-flex align-items-center justify-content-center bg-white position-relative">
            <div class="w-100 p-5 animate-fade-in" style="max-width: 500px;">
                <div class="text-center mb-5">
                    <div class="bg-primary bg-gradient text-white rounded-4 shadow-sm d-inline-flex align-items-center justify-content-center mb-4"
                        style="width: 72px; height: 72px;">
                        <i class="fas fa-layer-group fa-2x"></i>
                    </div>
                    <h3 class="fw-bold text-dark mb-1">Bienvenido</h3>
                    <p class="text-muted">Ingrese sus credenciales para continuar</p>
                </div>

                <form id="loginForm">
                    <div class="form-floating mb-3">
                        <input type="email" class="form-control bg-light border-0" id="email"
                            placeholder="name@example.com" required>
                        <label for="email" class="text-muted">Correo Corporativo</label>
                    </div>
                    <div class="form-floating mb-4">
                        <input type="password" class="form-control bg-light border-0" id="password"
                            placeholder="Password" required>
                        <label for="password" class="text-muted">Contraseña</label>
                    </div>

                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="rememberMe">
                            <label class="form-check-label text-muted small" for="rememberMe">Recordar sesión</label>
                        </div>
                        <a href="#" class="text-decoration-none small text-primary fw-bold hover-underline">¿Ayuda?</a>
                    </div>

                    <button type="submit"
                        class="btn btn-primary w-100 py-3 fw-bold shadow-lg mb-4 rounded-3 transition-transform">
                        Iniciar Sesión
                    </button>

                    <div class="alert alert-danger d-none border-0 shadow-sm bg-danger text-white rounded-3"
                        id="loginError">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-exclamation-triangle me-3 fs-4"></i>
                            <div>
                                <strong>Error de acceso</strong><br>
                                <small>Credenciales incorrectas. Intente nuevamente.</small>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="text-center mt-5">
                    <p class="text-muted small mb-0">&copy; 2026 Plataforma Corporativa</p>
                </div>
            </div>
        </div>
    </div>

    <style>
        @keyframes zoomIn {
            from {
                transform: scale(1);
            }

            to {
                transform: scale(1.05);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hover-underline:hover {
            text-decoration: underline !important;
        }

        .transition-transform:active {
            transform: scale(0.98);
        }
    </style>

    <!-- Load Common JS (Libs & Styles) -->
    <script src="common.js"></script>
    <script>
        // Override body background logic from common.js just for this page if needed, 
        // but since we define structure above styles, common.js styles will apply.
        // We use classes to override background.

        if (isAuthenticated()) window.location.href = "dashboard.html";

        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const alertBox = document.getElementById('loginError');

            const originalBtn = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verificando...';
            alertBox.classList.add('d-none');

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                // Check if running static demo (no backend)
                // If common.js API_URL is localhost but not running, it might fail.
                // Assuming backend is up as per user context.

                const res = await fetchAPI('/auth/login', {
                    method: 'POST',
                    body: JSON.stringify({ email, password })
                });

                if (res && res.ok) {
                    const data = await res.json();
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));

                    // Simple animation before redirect
                    btn.classList.remove('btn-primary');
                    btn.classList.add('btn-success');
                    btn.innerHTML = '<i class="fas fa-check"></i> Acceso Correcto';
                    setTimeout(() => window.location.href = 'dashboard.html', 500);
                } else {
                    throw new Error("Credenciales inválidas");
                }
            } catch (err) {
                alertBox.classList.remove('d-none');
                btn.disabled = false;
                btn.innerHTML = originalBtn;
                console.error(err);
            }
        });
    </script>
</body>

</html>